$(document).on("click", "#specialtyWrite", function(){
	const classList = document.querySelectorAll("#collapseTwo .collapse-item");
	for(item of classList){
		item.classList.remove("active");
	}
	$("#specialtyWrite").addClass("active");

    let msg = `<div class="container">
		<h2>전공등록</h2>
			<div class="mb-3">
				<label for="specialtyCode" class="form-label">전공 CODE</label>
				<input type="number" class="form-control" id="specialtyCode" >
			</div>
			<div class="mb-3">
				<label for="specialtyName" class="form-label">전공 이름</label>
				<input type="text" class="form-control" id="specialtyName" >
			</div>
			<button class="btn btn-primary" id="specialtyWriteBtn">등록</button>
	</div>`;
    $("#mainDiv").html(msg);
});

$(document).on("click","#specialtyWriteBtn",async function(){
	const specialtyCode = $("#specialtyCode").val();
	const specialtyName = $("#specialtyName").val();

	let data = JSON.stringify({ specialtyCode, specialtyName});
	console.log(data);
	
	data = await fetch("/api/specialty", {
		method: "POST",
		headers,
		body: data
	});
	data = await data;
	console.log(data.ok);
	// console.log(data);
	
	if (data.ok) {
		$("#specialtyList").click();
	} else {
		alert("의사 등록 실패")
	}
});

$(document).on("click","#specialtyList",specialtyList);
async function specialtyList(){
	let data = await fetch("/api/specialty", {method: "GET"});	
	data = await data;
	if(data.status==204){
		alert("등록된 전공이 없습니다.");
		$("#specialtyWriteBtn").click();
		return;
	}
	data = await data.json(); 
	const classList = document.querySelectorAll("#collapseTwo .collapse-item");
	for(item of classList){
		item.classList.remove("active");
	}
	$("#specialtyList").addClass("active");
	
	let htmlText = `
	<div class="container-fluid">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">글목록</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table text-center table-bordered" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>전공 CODE</th>
                                            <th>전공명</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;
									specialties = "";
	data.forEach(specialty => {
		specialties+=`<option value="${specialty.specialtyCode}" class="form-control">${specialty.specialtyName}</option>`
		htmlText+=`
		<tr>
        	<td>${specialty.specialtyCode}</td>
        	<td>${specialty.specialtyName}</td>
		</tr>	
		`;
	});
	htmlText+= `</tbody></table></div></div></div></div>`;
	$("#mainDiv").html(htmlText);
};