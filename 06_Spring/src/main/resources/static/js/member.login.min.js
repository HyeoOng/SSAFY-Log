const headers = { 'Content-Type': 'application/json' };
const email = sessionStorage.getItem("email");
if (email) {
	$("#email").val(email);
	$("#rememberCheck").prop("checked", true);
}

$("#loginBtn").click(async function() {
	const email = $("#email").val();
	const password = $("#password").val();

	let data = JSON.stringify({ email, password });
	data = await fetch("/api/member/login", {
		method: "POST",
		headers,
		body: data
	});

	if(!data.ok){
		let msg = await data.text();
		alert(msg);
		return;
	}

	data = await data.json();
	if(data.email){
		sessionStorage.setItem("loginEmail", data.email);
		sessionStorage.setItem("loginName", data.name);
		if ($("#rememberCheck").prop("checked")) {
			sessionStorage.setItem("email",data.email)
		}else{
			sessionStorage.removeItem("email");
		}
		location.href = "/main.html";
	}else{
		alert(data.msg);
		location.reload();
	}
});